<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Vulpes: vulpes::geometry::AbstractAgglomerationModel&lt; MeshType &gt; Class Template Reference</title>
<link rel="icon" href="vulpes_logo_notext_32.png" type="image/png" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-vulpes.js"></script>
<script type="text/javascript">
  DoxygenAwesomeDarkModeToggle.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-vulpes.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Vulpes
   &#160;<span id="projectnumber">0.0.2-alpha</span>
   </div>
   <div id="projectbrief">Virtual and Discontinuous Polytopal Elements Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">vulpes::geometry::AbstractAgglomerationModel&lt; MeshType &gt; Class Template Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div></div>
</div><!--header-->
<div class="contents">

<p>Defines an abstract interface for mesh agglomeration strategies.  
 <a href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="abs__agg__model_8hpp_source.html">abs_agg_model.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for vulpes::geometry::AbstractAgglomerationModel&lt; MeshType &gt;:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classvulpes_1_1geometry_1_1AbstractAgglomerationModel__inherit__graph.svg" width="582" height="179"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for vulpes::geometry::AbstractAgglomerationModel&lt; MeshType &gt;:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classvulpes_1_1geometry_1_1AbstractAgglomerationModel__coll__graph.svg" width="264" height="154"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a39ce37a8fd1673289143fe32ec65b230" id="r_a39ce37a8fd1673289143fe32ec65b230"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a39ce37a8fd1673289143fe32ec65b230">float_t</a> = double</td></tr>
<tr class="separator:a39ce37a8fd1673289143fe32ec65b230"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfe290106bdf16423be60af98d697aae" id="r_adfe290106bdf16423be60af98d697aae"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#adfe290106bdf16423be60af98d697aae">index_t</a> = int64_t</td></tr>
<tr class="separator:adfe290106bdf16423be60af98d697aae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f4a596f70921388fdaa11a5d7ce3135" id="r_a9f4a596f70921388fdaa11a5d7ce3135"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a9f4a596f70921388fdaa11a5d7ce3135">IndVec</a> = std::vector&lt; <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#adfe290106bdf16423be60af98d697aae">index_t</a> &gt;</td></tr>
<tr class="separator:a9f4a596f70921388fdaa11a5d7ce3135"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cb345a08dd2185c7c2b2808ed8ace0f" id="r_a6cb345a08dd2185c7c2b2808ed8ace0f"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a6cb345a08dd2185c7c2b2808ed8ace0f">MapType</a> = <a class="el" href="classvulpes_1_1datastructure_1_1CrsMap.html">datastructure::CrsMap</a>&lt; <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#adfe290106bdf16423be60af98d697aae">index_t</a>, <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#adfe290106bdf16423be60af98d697aae">index_t</a> &gt;</td></tr>
<tr class="separator:a6cb345a08dd2185c7c2b2808ed8ace0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d03379aa3b38f061fbb6763af74228c" id="r_a9d03379aa3b38f061fbb6763af74228c"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a9d03379aa3b38f061fbb6763af74228c">ParamType</a> = std::variant&lt; <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#adfe290106bdf16423be60af98d697aae">index_t</a>, <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a39ce37a8fd1673289143fe32ec65b230">float_t</a> &gt;</td></tr>
<tr class="separator:a9d03379aa3b38f061fbb6763af74228c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45a8567a0ce98c12b32452c2813450a8" id="r_a45a8567a0ce98c12b32452c2813450a8"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a45a8567a0ce98c12b32452c2813450a8">IndexTrackerType</a> = <a class="el" href="classvulpes_1_1datastructure_1_1IndexTracker.html">datastructure::IndexTracker</a>&lt; <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#adfe290106bdf16423be60af98d697aae">index_t</a> &gt;</td></tr>
<tr class="separator:a45a8567a0ce98c12b32452c2813450a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a18a7e71c309171e6c1ea99360a8bbcec" id="r_a18a7e71c309171e6c1ea99360a8bbcec"><td class="memItemLeft" align="right" valign="top">virtual std::vector&lt; MeshType &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a18a7e71c309171e6c1ea99360a8bbcec">agglomerate</a> (const MeshType &amp;mesh, <a class="el" href="namespacevulpes_1_1geometry.html#a730357b7b79829ebc6c34cf9737e871d">MethodType</a> method_type, <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a9d03379aa3b38f061fbb6763af74228c">ParamType</a> params, bool return_hierarchy=true, const std::string &amp;segregated_tag=&quot;&quot;, const <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a9f4a596f70921388fdaa11a5d7ce3135">IndVec</a> &amp;subset={})=0</td></tr>
<tr class="memdesc:a18a7e71c309171e6c1ea99360a8bbcec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Agglomerates a mesh according to a selected strategy.  <br /></td></tr>
<tr class="separator:a18a7e71c309171e6c1ea99360a8bbcec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecabff4294381ff69bb29b57bd13f7ec" id="r_aecabff4294381ff69bb29b57bd13f7ec"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#aecabff4294381ff69bb29b57bd13f7ec">directKWay</a> (const MeshType &amp;mesh, std::size_t n_groups, <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a45a8567a0ce98c12b32452c2813450a8">IndexTrackerType</a> &amp;indicator, const std::vector&lt; bool &gt; &amp;<a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a18a7e71c309171e6c1ea99360a8bbcec">agglomerate</a>)=0</td></tr>
<tr class="memdesc:aecabff4294381ff69bb29b57bd13f7ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs a direct k-way partition on the (sub)mesh.  <br /></td></tr>
<tr class="separator:aecabff4294381ff69bb29b57bd13f7ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87f8c6edf9e084b7eb5da0780a34461e" id="r_a87f8c6edf9e084b7eb5da0780a34461e"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a9f4a596f70921388fdaa11a5d7ce3135">IndVec</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a87f8c6edf9e084b7eb5da0780a34461e">multFactor</a> (const MeshType &amp;mesh, const <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a39ce37a8fd1673289143fe32ec65b230">float_t</a> target_h, <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a45a8567a0ce98c12b32452c2813450a8">IndexTrackerType</a> &amp;indicator, const std::vector&lt; bool &gt; &amp;<a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a18a7e71c309171e6c1ea99360a8bbcec">agglomerate</a>)</td></tr>
<tr class="memdesc:a87f8c6edf9e084b7eb5da0780a34461e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Partitions the mesh based on a multiplicative factor strategy.  <br /></td></tr>
<tr class="separator:a87f8c6edf9e084b7eb5da0780a34461e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95dd7d3c0dbd2a9f0d0693fd3b18d78a" id="r_a95dd7d3c0dbd2a9f0d0693fd3b18d78a"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a9f4a596f70921388fdaa11a5d7ce3135">IndVec</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a95dd7d3c0dbd2a9f0d0693fd3b18d78a">bisectNRef</a> (const MeshType &amp;mesh, const <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#adfe290106bdf16423be60af98d697aae">index_t</a> n_refs, <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a45a8567a0ce98c12b32452c2813450a8">IndexTrackerType</a> &amp;indicator, const std::vector&lt; bool &gt; &amp;<a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a18a7e71c309171e6c1ea99360a8bbcec">agglomerate</a>)</td></tr>
<tr class="memdesc:a95dd7d3c0dbd2a9f0d0693fd3b18d78a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies recursive bisection <code>n_refs</code> times.  <br /></td></tr>
<tr class="separator:a95dd7d3c0dbd2a9f0d0693fd3b18d78a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-attribs" name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a910c000cf397e31f882a11948a1274a2" id="r_a910c000cf397e31f882a11948a1274a2"><td class="memItemLeft" align="right" valign="top">static constexpr <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#adfe290106bdf16423be60af98d697aae">index_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a910c000cf397e31f882a11948a1274a2">dim</a> = MeshType::self_dim</td></tr>
<tr class="separator:a910c000cf397e31f882a11948a1274a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a334a6ee7475fae7309d81d34f16db57d" id="r_a334a6ee7475fae7309d81d34f16db57d"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a9f4a596f70921388fdaa11a5d7ce3135">IndVec</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a334a6ee7475fae7309d81d34f16db57d">invokeMethod</a> (const MeshType &amp;mesh, <a class="el" href="namespacevulpes_1_1geometry.html#a730357b7b79829ebc6c34cf9737e871d">MethodType</a> method_type, <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a9d03379aa3b38f061fbb6763af74228c">ParamType</a> params, const std::string &amp;segregation_tag, const <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a9f4a596f70921388fdaa11a5d7ce3135">IndVec</a> &amp;subset)</td></tr>
<tr class="memdesc:a334a6ee7475fae7309d81d34f16db57d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dispatches to the correct agglomeration method to compute cell labels.  <br /></td></tr>
<tr class="separator:a334a6ee7475fae7309d81d34f16db57d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13e92f911bdbf3360eacf9fb0e76d1b8" id="r_a13e92f911bdbf3360eacf9fb0e76d1b8"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a9f4a596f70921388fdaa11a5d7ce3135">IndVec</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a13e92f911bdbf3360eacf9fb0e76d1b8">bisectSubGraph</a> (const MeshType &amp;mesh, const <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a9f4a596f70921388fdaa11a5d7ce3135">IndVec</a> &amp;subgraph)=0</td></tr>
<tr class="memdesc:a13e92f911bdbf3360eacf9fb0e76d1b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Backend implementation of a single bisection operation.  <br /></td></tr>
<tr class="separator:a13e92f911bdbf3360eacf9fb0e76d1b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99641100d577a417cb944e162f8f5b5d" id="r_a99641100d577a417cb944e162f8f5b5d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a99641100d577a417cb944e162f8f5b5d">connectedComponents</a> (const <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a9f4a596f70921388fdaa11a5d7ce3135">IndVec</a> &amp;subset, <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a45a8567a0ce98c12b32452c2813450a8">IndexTrackerType</a> &amp;indicator, <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#adfe290106bdf16423be60af98d697aae">index_t</a> &amp;max_id)</td></tr>
<tr class="memdesc:a99641100d577a417cb944e162f8f5b5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Splits a set of cells into its connected components.  <br /></td></tr>
<tr class="separator:a99641100d577a417cb944e162f8f5b5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee80e7861e21c1ae0d3bdc3a26dae249" id="r_aee80e7861e21c1ae0d3bdc3a26dae249"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#aee80e7861e21c1ae0d3bdc3a26dae249">groupToBisection</a> (const <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a9f4a596f70921388fdaa11a5d7ce3135">IndVec</a> &amp;subset, const <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a9f4a596f70921388fdaa11a5d7ce3135">IndVec</a> &amp;classes, <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a45a8567a0ce98c12b32452c2813450a8">IndexTrackerType</a> &amp;indicator, <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#adfe290106bdf16423be60af98d697aae">index_t</a> new_id)</td></tr>
<tr class="memdesc:aee80e7861e21c1ae0d3bdc3a26dae249"><td class="mdescLeft">&#160;</td><td class="mdescRight">Post-processes a binary labeling to ensure two connected partitions.  <br /></td></tr>
<tr class="separator:aee80e7861e21c1ae0d3bdc3a26dae249"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:aa15e9370a222d854c030af8b030ab782" id="r_aa15e9370a222d854c030af8b030ab782"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a6cb345a08dd2185c7c2b2808ed8ace0f">MapType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#aa15e9370a222d854c030af8b030ab782">m_dual_map</a></td></tr>
<tr class="memdesc:aa15e9370a222d854c030af8b030ab782"><td class="mdescLeft">&#160;</td><td class="mdescRight">The dual graph of the mesh, cached for performance.  <br /></td></tr>
<tr class="separator:aa15e9370a222d854c030af8b030ab782"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;typename MeshType&gt;<br />
class vulpes::geometry::AbstractAgglomerationModel&lt; MeshType &gt;</div><p>Defines an abstract interface for mesh agglomeration strategies. </p>
<p>This class provides a common framework for various mesh partitioning and agglomeration algorithms (e.g., K-Means, ParMETIS, GNN-based). It exposes a uniform entry point to compute a labeling of mesh cells and then build the corresponding agglomerated (coarsened) mesh.</p>
<p>The primary strategies, identified by <code>MethodType</code>, are:</p><ul>
<li><code>BisectNRef</code>: Applies recursive bisection for <code>N_ref</code> levels, producing up to $2^{N_{ref}}$ partitions.</li>
<li><code>MultFactor</code>: Recursively splits any partition whose vertex-vertex diameter exceeds a certain threshold, then finalizes partitions by connectivity.</li>
<li><code>DirectKWay</code>: Performs a single-shot k-way partition (note: not all backends may support this).</li>
</ul>
<p>All methods support a segregated mode, where disjoint subdomains of the mesh (identified by a <code><a class="el" href="structvulpes_1_1geometry_1_1MeshTag.html" title="A structure to store tags for different parts of a mesh.">MeshTag</a></code>) are agglomerated independently.</p>
<p>Derived classes must implement the low-level bisection primitive <code><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a13e92f911bdbf3360eacf9fb0e76d1b8" title="Backend implementation of a single bisection operation.">bisectSubGraph()</a></code> and/or the direct k-way routine <code><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#aecabff4294381ff69bb29b57bd13f7ec" title="Performs a direct k-way partition on the (sub)mesh.">directKWay()</a></code>.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">MeshType</td><td>The concrete mesh type being agglomerated (e.g., <code><a class="el" href="classvulpes_1_1geometry_1_1Mesh2D.html" title="A class for a 2D mesh, inheriting from MeshBase.">Mesh2D</a></code>, <code><a class="el" href="classvulpes_1_1geometry_1_1Mesh3D.html" title="Represents a 3D mesh.">Mesh3D</a></code>).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a18a7e71c309171e6c1ea99360a8bbcec" title="Agglomerates a mesh according to a selected strategy.">agglomerate()</a>, <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a334a6ee7475fae7309d81d34f16db57d" title="Dispatches to the correct agglomeration method to compute cell labels.">invokeMethod()</a>, <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a95dd7d3c0dbd2a9f0d0693fd3b18d78a" title="Applies recursive bisection n_refs times.">bisectNRef()</a>, <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a87f8c6edf9e084b7eb5da0780a34461e" title="Partitions the mesh based on a multiplicative factor strategy.">multFactor()</a> </dd></dl>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="a39ce37a8fd1673289143fe32ec65b230" name="a39ce37a8fd1673289143fe32ec65b230"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39ce37a8fd1673289143fe32ec65b230">&#9670;&#160;</a></span>float_t</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MeshType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html">vulpes::geometry::AbstractAgglomerationModel</a>&lt; MeshType &gt;::float_t =  double</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="adfe290106bdf16423be60af98d697aae" name="adfe290106bdf16423be60af98d697aae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfe290106bdf16423be60af98d697aae">&#9670;&#160;</a></span>index_t</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MeshType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html">vulpes::geometry::AbstractAgglomerationModel</a>&lt; MeshType &gt;::index_t =  int64_t</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a45a8567a0ce98c12b32452c2813450a8" name="a45a8567a0ce98c12b32452c2813450a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45a8567a0ce98c12b32452c2813450a8">&#9670;&#160;</a></span>IndexTrackerType</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MeshType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html">vulpes::geometry::AbstractAgglomerationModel</a>&lt; MeshType &gt;::IndexTrackerType =  <a class="el" href="classvulpes_1_1datastructure_1_1IndexTracker.html">datastructure::IndexTracker</a>&lt;<a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#adfe290106bdf16423be60af98d697aae">index_t</a>&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9f4a596f70921388fdaa11a5d7ce3135" name="a9f4a596f70921388fdaa11a5d7ce3135"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f4a596f70921388fdaa11a5d7ce3135">&#9670;&#160;</a></span>IndVec</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MeshType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html">vulpes::geometry::AbstractAgglomerationModel</a>&lt; MeshType &gt;::IndVec =  std::vector&lt;<a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#adfe290106bdf16423be60af98d697aae">index_t</a>&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6cb345a08dd2185c7c2b2808ed8ace0f" name="a6cb345a08dd2185c7c2b2808ed8ace0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cb345a08dd2185c7c2b2808ed8ace0f">&#9670;&#160;</a></span>MapType</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MeshType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html">vulpes::geometry::AbstractAgglomerationModel</a>&lt; MeshType &gt;::MapType =  <a class="el" href="classvulpes_1_1datastructure_1_1CrsMap.html">datastructure::CrsMap</a>&lt;<a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#adfe290106bdf16423be60af98d697aae">index_t</a>, <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#adfe290106bdf16423be60af98d697aae">index_t</a>&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9d03379aa3b38f061fbb6763af74228c" name="a9d03379aa3b38f061fbb6763af74228c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d03379aa3b38f061fbb6763af74228c">&#9670;&#160;</a></span>ParamType</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MeshType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html">vulpes::geometry::AbstractAgglomerationModel</a>&lt; MeshType &gt;::ParamType =  std::variant&lt;<a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#adfe290106bdf16423be60af98d697aae">index_t</a>, <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a39ce37a8fd1673289143fe32ec65b230">float_t</a>&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a18a7e71c309171e6c1ea99360a8bbcec" name="a18a7e71c309171e6c1ea99360a8bbcec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18a7e71c309171e6c1ea99360a8bbcec">&#9670;&#160;</a></span>agglomerate()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MeshType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual std::vector&lt; MeshType &gt; <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html">vulpes::geometry::AbstractAgglomerationModel</a>&lt; MeshType &gt;::agglomerate </td>
          <td>(</td>
          <td class="paramtype">const MeshType &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacevulpes_1_1geometry.html#a730357b7b79829ebc6c34cf9737e871d">MethodType</a>&#160;</td>
          <td class="paramname"><em>method_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a9d03379aa3b38f061fbb6763af74228c">ParamType</a>&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>return_hierarchy</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>segregated_tag</em> = <code>&quot;&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a9f4a596f70921388fdaa11a5d7ce3135">IndVec</a> &amp;&#160;</td>
          <td class="paramname"><em>subset</em> = <code>{}</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Agglomerates a mesh according to a selected strategy. </p>
<p>This is the main entry point for agglomeration. It dispatches to the chosen <code>method_type</code> using the provided <code>params</code>. The operation can be restricted to a <code>subset</code> of cell IDs and can operate in a segregated fashion if a <code>segregated_tag</code> is provided.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mesh</td><td>The input mesh to agglomerate. </td></tr>
    <tr><td class="paramname">method_type</td><td>The strategy to use, e.g., <code>BisectNRef</code>, <code>MultFactor</code>, <code>DirectKWay</code>. </td></tr>
    <tr><td class="paramname">params</td><td>Parameters for the chosen strategy:<ul>
<li><code>BisectNRef</code>: <code>index_t n_refs</code> (number of bisection levels).</li>
<li><code>MultFactor</code>: <code>float_t target_h</code> (target diameter).</li>
<li><code>DirectKWay</code>: <code>index_t k</code> (number of partitions). </li>
</ul>
</td></tr>
    <tr><td class="paramname">return_hierarchy</td><td>If true, returns all intermediate meshes from recursive strategies. If false, returns only the final agglomerated mesh. </td></tr>
    <tr><td class="paramname">segregated_tag</td><td>If non-empty, specifies the mesh tag for segregated agglomeration, where each tagged region is processed independently. If the tags indicates parts of the domain that are not connected they are automatically recognised and splitted. The agglomeration procedure is applied to each sub domain independently. </td></tr>
    <tr><td class="paramname">subset</td><td>Optional list of cell IDs to agglomerate. If empty, the entire mesh is processed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A vector of <code>MeshType</code>. If <code>return_hierarchy</code> is true, this includes all intermediate meshes; otherwise, it contains only the final result.</dd></dl>
<dl class="section pre"><dt>Precondition</dt><dd>For <code>DirectKWay</code>, <code>k</code> must be \(\ge 1\) and \(\le\) the number of cells being processed. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>The typical implementation flow is: (1) compute a label vector via <code><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a334a6ee7475fae7309d81d34f16db57d" title="Dispatches to the correct agglomeration method to compute cell labels.">invokeMethod()</a></code>, then (2) build the new mesh via a call to a mesh construction method like <code>mesh.agglomerateBase()</code>. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a334a6ee7475fae7309d81d34f16db57d" title="Dispatches to the correct agglomeration method to compute cell labels.">invokeMethod()</a>, <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#aecabff4294381ff69bb29b57bd13f7ec" title="Performs a direct k-way partition on the (sub)mesh.">directKWay()</a>, <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a87f8c6edf9e084b7eb5da0780a34461e" title="Partitions the mesh based on a multiplicative factor strategy.">multFactor()</a>, <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a95dd7d3c0dbd2a9f0d0693fd3b18d78a" title="Applies recursive bisection n_refs times.">bisectNRef()</a> </dd></dl>

<p>Implemented in <a class="el" href="classvulpes_1_1geometry_1_1GNNAgglomeration.html#af7e2bdfaaf2c449eb3b216cddcd08b6b">vulpes::geometry::GNNAgglomeration&lt; MeshType &gt;</a>, <a class="el" href="classvulpes_1_1geometry_1_1KMeansAgglomeration.html#a844b6d92afa36f55de6e2491e07d5ca1">vulpes::geometry::KMeansAgglomeration&lt; MeshType &gt;</a>, and <a class="el" href="classvulpes_1_1geometry_1_1ParmetisAgglomeration.html#a33072cec86779e74cdc9d953caf8e666">vulpes::geometry::ParmetisAgglomeration&lt; MeshType &gt;</a>.</p>

</div>
</div>
<a id="a95dd7d3c0dbd2a9f0d0693fd3b18d78a" name="a95dd7d3c0dbd2a9f0d0693fd3b18d78a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95dd7d3c0dbd2a9f0d0693fd3b18d78a">&#9670;&#160;</a></span>bisectNRef()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MeshType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; typename <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html">AbstractAgglomerationModel</a>&lt; MeshType &gt;<a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a9f4a596f70921388fdaa11a5d7ce3135">::IndVec</a> &gt; <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html">vulpes::geometry::AbstractAgglomerationModel</a>&lt; MeshType &gt;::bisectNRef </td>
          <td>(</td>
          <td class="paramtype">const MeshType &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#adfe290106bdf16423be60af98d697aae">index_t</a>&#160;</td>
          <td class="paramname"><em>n_refs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a45a8567a0ce98c12b32452c2813450a8">IndexTrackerType</a> &amp;&#160;</td>
          <td class="paramname"><em>indicator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; bool &gt; &amp;&#160;</td>
          <td class="paramname"><em>agglomerate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies recursive bisection <code>n_refs</code> times. </p>
<p>This method takes an initial partitioning and refines it by applying the <code><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a13e92f911bdbf3360eacf9fb0e76d1b8" title="Backend implementation of a single bisection operation.">bisectSubGraph()</a></code> primitive recursively for <code>n_refs</code> levels. Each step splits a partition into two. The base cases are finalized by ensuring connectivity via <code><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a99641100d577a417cb944e162f8f5b5d" title="Splits a set of cells into its connected components.">connectedComponents()</a></code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">mesh</td><td>The input mesh. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">n_refs</td><td>The number of recursive bisection levels to apply ( \(n_{refs} \ge 0\)). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">indicator</td><td>The label tracker, which is updated with the results. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">agglomerate</td><td>A boolean vector indicating which initial classes in <code>indicator</code> are eligible for bisection. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A hierarchy of label vectors, capturing the state of partitioning at each level of bisection.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a13e92f911bdbf3360eacf9fb0e76d1b8" title="Backend implementation of a single bisection operation.">bisectSubGraph()</a>, <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a99641100d577a417cb944e162f8f5b5d" title="Splits a set of cells into its connected components.">connectedComponents()</a> </dd></dl>

</div>
</div>
<a id="a13e92f911bdbf3360eacf9fb0e76d1b8" name="a13e92f911bdbf3360eacf9fb0e76d1b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13e92f911bdbf3360eacf9fb0e76d1b8">&#9670;&#160;</a></span>bisectSubGraph()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MeshType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a9f4a596f70921388fdaa11a5d7ce3135">IndVec</a> <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html">vulpes::geometry::AbstractAgglomerationModel</a>&lt; MeshType &gt;::bisectSubGraph </td>
          <td>(</td>
          <td class="paramtype">const MeshType &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a9f4a596f70921388fdaa11a5d7ce3135">IndVec</a> &amp;&#160;</td>
          <td class="paramname"><em>subgraph</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Backend implementation of a single bisection operation. </p>
<p>Given a set of cell IDs forming a subgraph, this pure virtual function must be implemented by derived classes to split the subgraph into two parts.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mesh</td><td>The input mesh. </td></tr>
    <tr><td class="paramname">subgraph</td><td>A vector of cell IDs to be split. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A vector of binary labels (e.g., 0s and 1s) of the same size as <code>subgraph</code>, assigning each cell to one of the two new partitions. </dd></dl>

<p>Implemented in <a class="el" href="classvulpes_1_1geometry_1_1GNNAgglomeration.html#ab28024c6d368900bf38434152bada274">vulpes::geometry::GNNAgglomeration&lt; MeshType &gt;</a>, <a class="el" href="classvulpes_1_1geometry_1_1KMeansAgglomeration.html#a8289bb9f2b5eac8f8cfd786c30d077a0">vulpes::geometry::KMeansAgglomeration&lt; MeshType &gt;</a>, and <a class="el" href="classvulpes_1_1geometry_1_1ParmetisAgglomeration.html#ab292c45d8094c237e1ba412c22d08b98">vulpes::geometry::ParmetisAgglomeration&lt; MeshType &gt;</a>.</p>

</div>
</div>
<a id="a99641100d577a417cb944e162f8f5b5d" name="a99641100d577a417cb944e162f8f5b5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99641100d577a417cb944e162f8f5b5d">&#9670;&#160;</a></span>connectedComponents()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MeshType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html">vulpes::geometry::AbstractAgglomerationModel</a>&lt; MeshType &gt;::connectedComponents </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a9f4a596f70921388fdaa11a5d7ce3135">IndVec</a> &amp;&#160;</td>
          <td class="paramname"><em>subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a45a8567a0ce98c12b32452c2813450a8">IndexTrackerType</a> &amp;&#160;</td>
          <td class="paramname"><em>indicator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#adfe290106bdf16423be60af98d697aae">index_t</a> &amp;&#160;</td>
          <td class="paramname"><em>max_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Splits a set of cells into its connected components. </p>
<p>This function examines the dual graph restricted to the cells in <code>subset</code>. If the subgraph is disconnected, each connected component is assigned a new, unique label. This is often used as a finalization step in recursive strategies.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">subset</td><td>The set of cell IDs to process. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">indicator</td><td>The global label tracker, which will be updated. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">max_id</td><td>The last used label ID; it is incremented for each new component found. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aecabff4294381ff69bb29b57bd13f7ec" name="aecabff4294381ff69bb29b57bd13f7ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecabff4294381ff69bb29b57bd13f7ec">&#9670;&#160;</a></span>directKWay()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MeshType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html">vulpes::geometry::AbstractAgglomerationModel</a>&lt; MeshType &gt;::directKWay </td>
          <td>(</td>
          <td class="paramtype">const MeshType &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>n_groups</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a45a8567a0ce98c12b32452c2813450a8">IndexTrackerType</a> &amp;&#160;</td>
          <td class="paramname"><em>indicator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; bool &gt; &amp;&#160;</td>
          <td class="paramname"><em>agglomerate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Performs a direct k-way partition on the (sub)mesh. </p>
<p>This method must be implemented by backends that support single-shot k-way partitioning (e.g., K-Means, ParMETIS). It partitions the active cells into <code>n_groups</code> sets, updating the <code>indicator</code> with the new labels.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">mesh</td><td>The input mesh. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">n_groups</td><td>The target number of partitions. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">indicator</td><td>The label tracker. It can be pre-filled to provide a warm start. It will be updated with the final labels. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">agglomerate</td><td>A boolean vector where the i-th element indicates if the i-th class in the initial <code>indicator</code> should be re-partitioned. </td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="classvulpes_1_1geometry_1_1GNNAgglomeration.html#aa27f797c3ce82f33c2f066341fc329ae">vulpes::geometry::GNNAgglomeration&lt; MeshType &gt;</a>, <a class="el" href="classvulpes_1_1geometry_1_1KMeansAgglomeration.html#ab19d05657dbc44e9c665edd24ac7ba5a">vulpes::geometry::KMeansAgglomeration&lt; MeshType &gt;</a>, and <a class="el" href="classvulpes_1_1geometry_1_1ParmetisAgglomeration.html#ae67cfa5b730773ba326433ea6a6041d2">vulpes::geometry::ParmetisAgglomeration&lt; MeshType &gt;</a>.</p>

</div>
</div>
<a id="aee80e7861e21c1ae0d3bdc3a26dae249" name="aee80e7861e21c1ae0d3bdc3a26dae249"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee80e7861e21c1ae0d3bdc3a26dae249">&#9670;&#160;</a></span>groupToBisection()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MeshType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html">vulpes::geometry::AbstractAgglomerationModel</a>&lt; MeshType &gt;::groupToBisection </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a9f4a596f70921388fdaa11a5d7ce3135">IndVec</a> &amp;&#160;</td>
          <td class="paramname"><em>subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a9f4a596f70921388fdaa11a5d7ce3135">IndVec</a> &amp;&#160;</td>
          <td class="paramname"><em>classes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a45a8567a0ce98c12b32452c2813450a8">IndexTrackerType</a> &amp;&#160;</td>
          <td class="paramname"><em>indicator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#adfe290106bdf16423be60af98d697aae">index_t</a>&#160;</td>
          <td class="paramname"><em>new_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Post-processes a binary labeling to ensure two connected partitions. </p>
<p>Given a provisional two-class labeling for a <code>subset</code> of cells, this method refines the labels to ensure that the resulting two partitions are each internally connected. It can relabel "islands" of cells to join the surrounding partition.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">subset</td><td>The set of cell IDs under consideration. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">classes</td><td>A vector of provisional binary labels for the cells in <code>subset</code>. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">indicator</td><td>The global label tracker to update with the final bisection. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">new_id</td><td>The fresh label ID to be assigned to one of the two final partitions. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a334a6ee7475fae7309d81d34f16db57d" name="a334a6ee7475fae7309d81d34f16db57d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a334a6ee7475fae7309d81d34f16db57d">&#9670;&#160;</a></span>invokeMethod()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MeshType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; typename <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html">AbstractAgglomerationModel</a>&lt; MeshType &gt;<a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a9f4a596f70921388fdaa11a5d7ce3135">::IndVec</a> &gt; <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html">vulpes::geometry::AbstractAgglomerationModel</a>&lt; MeshType &gt;::invokeMethod </td>
          <td>(</td>
          <td class="paramtype">const MeshType &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacevulpes_1_1geometry.html#a730357b7b79829ebc6c34cf9737e871d">MethodType</a>&#160;</td>
          <td class="paramname"><em>method_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a9d03379aa3b38f061fbb6763af74228c">ParamType</a>&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>segregation_tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a9f4a596f70921388fdaa11a5d7ce3135">IndVec</a> &amp;&#160;</td>
          <td class="paramname"><em>subset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Dispatches to the correct agglomeration method to compute cell labels. </p>
<p>This is a wrapper function typically used by <code><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a18a7e71c309171e6c1ea99360a8bbcec" title="Agglomerates a mesh according to a selected strategy.">agglomerate()</a></code>. It selects the appropriate backend method based on <code>method_type</code> and restricts the computation to <code>subset</code> if it is non-empty.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mesh</td><td>The input mesh. </td></tr>
    <tr><td class="paramname">method_type</td><td>The strategy to apply. </td></tr>
    <tr><td class="paramname">params</td><td>The parameters for the chosen strategy. </td></tr>
    <tr><td class="paramname">segregation_tag</td><td>If non-empty, the mesh tag to use for segregated processing. </td></tr>
    <tr><td class="paramname">subset</td><td>An optional subset of cell IDs to operate on. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A hierarchy of label vectors. For cells not in <code>subset</code>, the label is typically unchanged or set to a sentinel value (e.g., -1). </dd></dl>

</div>
</div>
<a id="a87f8c6edf9e084b7eb5da0780a34461e" name="a87f8c6edf9e084b7eb5da0780a34461e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87f8c6edf9e084b7eb5da0780a34461e">&#9670;&#160;</a></span>multFactor()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MeshType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; typename <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html">AbstractAgglomerationModel</a>&lt; MeshType &gt;<a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a9f4a596f70921388fdaa11a5d7ce3135">::IndVec</a> &gt; <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html">vulpes::geometry::AbstractAgglomerationModel</a>&lt; MeshType &gt;::multFactor </td>
          <td>(</td>
          <td class="paramtype">const MeshType &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a39ce37a8fd1673289143fe32ec65b230">float_t</a>&#160;</td>
          <td class="paramname"><em>target_h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a45a8567a0ce98c12b32452c2813450a8">IndexTrackerType</a> &amp;&#160;</td>
          <td class="paramname"><em>indicator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; bool &gt; &amp;&#160;</td>
          <td class="paramname"><em>agglomerate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Partitions the mesh based on a multiplicative factor strategy. </p>
<p>This method recursively bisects any group whose vertex-vertex diameter exceeds the <code>target_h</code>. After geometric splitting, each resulting group is finalized by splitting it into its connected components. It uses <code><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a13e92f911bdbf3360eacf9fb0e76d1b8" title="Backend implementation of a single bisection operation.">bisectSubGraph()</a></code> as the core splitting primitive.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">mesh</td><td>The input mesh. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">target_h</td><td>The target characteristic length. Any group with a diameter larger than this will be split. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">indicator</td><td>The label tracker, which is updated with the results. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">agglomerate</td><td>A boolean vector indicating which initial classes in <code>indicator</code> are eligible for splitting. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A hierarchy of label vectors, where each vector represents the partitioning at a successive level of refinement.</dd></dl>
<dl class="section pre"><dt>Precondition</dt><dd><code>target_h</code> must be a positive value. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a99641100d577a417cb944e162f8f5b5d" title="Splits a set of cells into its connected components.">connectedComponents()</a>, <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a13e92f911bdbf3360eacf9fb0e76d1b8" title="Backend implementation of a single bisection operation.">bisectSubGraph()</a> </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a910c000cf397e31f882a11948a1274a2" name="a910c000cf397e31f882a11948a1274a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a910c000cf397e31f882a11948a1274a2">&#9670;&#160;</a></span>dim</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MeshType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#adfe290106bdf16423be60af98d697aae">index_t</a> <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html">vulpes::geometry::AbstractAgglomerationModel</a>&lt; MeshType &gt;::dim = MeshType::self_dim</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa15e9370a222d854c030af8b030ab782" name="aa15e9370a222d854c030af8b030ab782"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa15e9370a222d854c030af8b030ab782">&#9670;&#160;</a></span>m_dual_map</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename MeshType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html#a6cb345a08dd2185c7c2b2808ed8ace0f">MapType</a> <a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html">vulpes::geometry::AbstractAgglomerationModel</a>&lt; MeshType &gt;::m_dual_map</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The dual graph of the mesh, cached for performance. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/__w/vulpes/vulpes/vulpes/geometry/agglomeration/<a class="el" href="abs__agg__model_8hpp_source.html">abs_agg_model.hpp</a></li>
<li>/__w/vulpes/vulpes/vulpes/geometry/agglomeration/<a class="el" href="abs__agg__model_8cpp.html">abs_agg_model.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacevulpes.html">vulpes</a></li><li class="navelem"><a class="el" href="namespacevulpes_1_1geometry.html">geometry</a></li><li class="navelem"><a class="el" href="classvulpes_1_1geometry_1_1AbstractAgglomerationModel.html">AbstractAgglomerationModel</a></li>
    <li class="footer">Generated on Mon Dec 15 2025 15:49:41 for Vulpes by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
